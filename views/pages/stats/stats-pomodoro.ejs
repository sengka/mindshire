<div class="fixed-background"></div>

<section class="stats-page">
    <div class="stats-container">
        <div class="stats-header">
            <h1 class="stats-title">üçÖ Pomodoro Ge√ßmi≈üi</h1>
            <p class="stats-subtitle">T√ºm odak seanslarƒ±nƒ±n detaylƒ± kaydƒ±</p>
        </div>

        <!-- Filtreleme -->
        <div class="stats-filters">
            <form method="GET" action="/stats/pomodoro" class="filter-form">
                <div class="filter-group">
                    <label>Mod:</label>
                    <select name="mode" class="filter-select">
                        <option value="all" <%=filters.mode==='all' ? 'selected' : '' %>>T√ºm√º</option>
                        <option value="work" <%=filters.mode==='work' ? 'selected' : '' %>>üçÖ Odak</option>
                        <option value="short" <%=filters.mode==='short' ? 'selected' : '' %>>‚òï Kƒ±sa Mola</option>
                        <option value="long" <%=filters.mode==='long' ? 'selected' : '' %>>üåô Uzun Mola</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label>Ba≈ülangƒ±√ß:</label>
                    <input type="date" name="startDate" value="<%= filters.startDate %>" class="filter-input">
                </div>

                <div class="filter-group">
                    <label>Biti≈ü:</label>
                    <input type="date" name="endDate" value="<%= filters.endDate %>" class="filter-input">
                </div>

                <button type="submit" class="btn-primary">Filtrele</button>
                <a href="/stats/pomodoro" class="btn-secondary">Temizle</a>
            </form>
        </div>

        <!-- Pomodoro Tablosu -->
        <div class="stats-section">
            <% if (sessions && sessions.length> 0) { %>
                <div class="pomodoro-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Tarih</th>
                                <th>Mod</th>
                                <th>Planlanan</th>
                                <th>Ger√ßekle≈üen</th>
                                <th>Durum</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% sessions.forEach(session=> { %>
                                <tr>
                                    <td>
                                        <%= session.startedAtFormatted %>
                                    </td>
                                    <td>
                                        <%= session.modeLabel %>
                                    </td>
                                    <td>
                                        <%= session.plannedMinutes %> dk
                                    </td>
                                    <td>
                                        <%= session.duration %>
                                    </td>
                                    <td><span class="status-badge status-<%= session.status %>">
                                            <%= session.statusLabel %>
                                        </span></td>
                                </tr>
                                <% }) %>
                        </tbody>
                    </table>
                </div>

                <!-- Sayfalama -->
                <div class="pagination">
                    <% if (pagination.hasPrev) { %>
                        <a href="/stats/pomodoro?page=<%= pagination.currentPage - 1 %>&mode=<%= filters.mode %>&startDate=<%= filters.startDate %>&endDate=<%= filters.endDate %>"
                            class="btn-secondary">‚Üê √ñnceki</a>
                        <% } %>

                            <span class="pagination-info">
                                Sayfa <%= pagination.currentPage %> / <%= pagination.totalPages %>
                                        (Toplam: <%= pagination.totalSessions %> seans)
                            </span>

                            <% if (pagination.hasNext) { %>
                                <a href="/stats/pomodoro?page=<%= pagination.currentPage + 1 %>&mode=<%= filters.mode %>&startDate=<%= filters.startDate %>&endDate=<%= filters.endDate %>"
                                    class="btn-secondary">Sonraki ‚Üí</a>
                                <% } %>
                </div>
                <% } else { %>
                    <p class="empty-state">Hen√ºz pomodoro kaydƒ± yok. √áalƒ±≈ümaya ba≈üla!</p>
                    <% } %>
        </div>

        <!-- Geri D√∂n -->
        <div class="stats-back">
            <a href="/stats" class="btn-secondary">‚Üê Genel ƒ∞statistiklere D√∂n</a>
        </div>
    </div>
</section>